
<div class="max-w-4xl mx-auto">
  <header class="mb-12">
    <div class="text-sm text-gray-400 mb-3 flex items-center gap-2">
      <a routerLink="/learning" class="hover:text-blue-accent hover:underline">Trilhas de Aprendizagem</a>
      <span class="material-icons-outlined text-base">chevron_right</span>
      <a routerLink="/learning/python-machine-learning-sklearn" class="hover:text-blue-accent hover:underline">Introdução ao Machine Learning com Scikit-learn</a>
    </div>
    <h1 class="text-4xl md:text-5xl font-bold text-white tracking-tight">Laboratório: Seu Primeiro Modelo Preditivo</h1>
    <p class="mt-4 text-lg text-gray-400">Treine um modelo de regressão passo a passo para prever valores numéricos e entenda o ciclo de `fit` e `predict`.</p>
  </header>
  <article class="prose-container space-y-12">
    <p>
      Vamos colocar a teoria em prática! Nesta lição, construiremos um modelo de Machine Learning do início ao fim. Nosso objetivo será prever o preço mediano de casas na Califórnia com base em características da região. Este é um problema clássico de <strong>regressão</strong> (prever um valor contínuo).
    </p>

    <!-- Passo 1 -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">1. Carregando os Dados</h2>
      <p class="text-gray-300 mb-6">
        O Scikit-learn já vem com alguns conjuntos de dados clássicos para aprendizado. Vamos usar o "California Housing" e colocá-lo em um DataFrame do Pandas para facilitar a visualização. Clique em 'Run' para carregar os dados.
      </p>
      <app-python-console [initialCode]="codeLoadData" outputHeight="250px"></app-python-console>
    </section>

    <!-- Passo 2 -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">2. Separando "Perguntas" e "Respostas"</h2>
      <p class="text-gray-300 mb-6">
        O modelo precisa saber o que são as "perguntas" (as características, ou <strong>features</strong>) e o que é a "resposta" que ele deve aprender a prever (o <strong>target</strong>). Por convenção, chamamos as features de <code>X</code> e o target de <code>y</code>.
      </p>
      <app-python-console [initialCode]="codeSplitXY" [setupCode]="setupCodeSplitXY" outputHeight="150px"></app-python-console>
    </section>

    <!-- Passo 3 -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">3. Dividindo os Dados: Treino e Teste</h2>
      <p class="text-gray-300 mb-6">
        Este é o passo mais crucial. Nunca devemos avaliar nosso modelo com os mesmos dados que usamos para treiná-lo. Seria como dar ao aluno as respostas da prova antes do teste! Dividimos os dados em um conjunto para treinar e outro para testar o quão bem o modelo generaliza para dados novos.
      </p>
       <app-python-console [initialCode]="codeTrainTest" [setupCode]="setupCodeTrainTest" outputHeight="150px"></app-python-console>
    </section>

    <!-- Passo 4 -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">4. Escolhendo e Treinando o Modelo</h2>
      <p class="text-gray-300 mb-6">
        Vamos começar com o modelo mais simples para regressão: a <strong>Regressão Linear</strong>. Ele tentará encontrar a melhor "linha" que se ajusta aos dados. O treinamento acontece com o método <code>.fit()</code>. É aqui que o modelo "estuda" os dados de treino para aprender a relação entre as features (<code>X_train</code>) e o target (<code>y_train</code>).
      </p>
      <app-python-console [initialCode]="codeTrainModel" [setupCode]="setupCodeTrainModel" outputHeight="150px"></app-python-console>
    </section>
    
    <!-- Passo 5 -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">5. Fazendo Previsões</h2>
      <p class="text-gray-300 mb-6">
        Com o modelo treinado, podemos usar o método <code>.predict()</code> para fazer previsões nos nossos dados de teste, que o modelo nunca viu antes.
      </p>
       <app-python-console [initialCode]="codePredict" [setupCode]="setupCodePredict" outputHeight="220px"></app-python-console>
    </section>

    <div class="p-6 bg-green-900/30 border border-green-700/50 text-green-300 rounded-lg">
      <h3 class="font-semibold text-green-200 text-lg mb-2">Conclusão: O Ciclo `fit`/`predict`</h3>
      <p>
        Você acabou de completar o ciclo fundamental de Machine Learning Supervisionado: carregar dados, dividi-los, treinar um modelo com <code>.fit()</code> e fazer previsões com <code>.predict()</code>.
      </p>
      <p>
        Nossas previsões parecem estar na mesma ordem de magnitude dos valores reais, mas quão boas elas são exatamente? No próximo artigo, aprenderemos a usar métricas para quantificar a performance do nosso modelo.
      </p>
    </div>

    <div class="pt-8 text-center">
       <a routerLink="/learning/python-machine-learning-sklearn" class="inline-flex items-center gap-2 px-6 py-3 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors">
        <span class="material-icons-outlined">arrow_forward</span>
        Próximo Passo: Avaliando a Performance
      </a>
    </div>
  </article>
</div>
