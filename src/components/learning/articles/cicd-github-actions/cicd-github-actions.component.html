
<div class="max-w-4xl mx-auto">
  <header class="mb-12">
    <div class="text-sm text-gray-400 mb-3 flex items-center gap-2">
      <a routerLink="/learning" class="hover:text-blue-accent hover:underline">Trilhas de Aprendizagem</a>
      <span class="material-icons-outlined text-base">chevron_right</span>
      <a routerLink="/learning/devops-fundamentos" class="hover:text-blue-accent hover:underline">Fundamentos de DevOps</a>
    </div>
    <h1 class="text-4xl md:text-5xl font-bold text-white tracking-tight">CI/CD na Prática com GitHub Actions</h1>
    <p class="mt-4 text-lg text-gray-400">Aprenda a criar um pipeline de Integração e Entrega Contínua para automatizar testes e deploys a cada commit.</p>
  </header>

  <article class="prose-container space-y-10">
    
    <!-- Pipeline Simulator -->
    <div class="p-6 bg-gray-900 border border-gray-800 rounded-lg">
      <div class="flex justify-between items-center mb-6">
          <h2 class="text-xl font-bold text-white m-0 flex items-center gap-2">
              <span class="material-icons-outlined text-blue-500">rocket_launch</span> Simulador de Pipeline
          </h2>
          <div class="flex gap-2">
             @if(pipelineState() === 'idle' || pipelineState() === 'success' || pipelineState() === 'failed') {
                 <button (click)="startPipeline()" class="px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm font-bold transition-colors flex items-center gap-2">
                     <span class="material-icons-outlined text-sm">play_arrow</span> Disparar Push
                 </button>
             }
             @if(pipelineState() === 'success' || pipelineState() === 'failed') {
                 <button (click)="resetPipeline()" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm font-bold transition-colors">Resetar</button>
             }
          </div>
      </div>

      <!-- Visual Steps -->
      <div class="flex items-center justify-between mb-8 relative">
          <!-- Progress Bar Background -->
          <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-800 -z-10 transform -translate-y-1/2"></div>
          
          <!-- Step 1: Build -->
          <div class="flex flex-col items-center gap-2">
              <div class="w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all duration-500"
                   [class.bg-gray-800]="currentStep() < 1" [class.border-gray-600]="currentStep() < 1"
                   [class.bg-blue-900]="currentStep() === 1" [class.border-blue-500]="currentStep() === 1" [class.animate-pulse]="currentStep() === 1"
                   [class.bg-green-900]="currentStep() > 1" [class.border-green-500]="currentStep() > 1">
                   @if(currentStep() > 1) { <span class="material-icons text-green-500 text-sm">check</span> }
                   @else if(currentStep() === 1) { <span class="material-icons text-blue-500 text-sm animate-spin">sync</span> }
                   @else { <span class="text-gray-500 text-xs">1</span> }
              </div>
              <span class="text-xs font-bold" [class.text-blue-400]="currentStep() >= 1" [class.text-gray-500]="currentStep() < 1">Build</span>
          </div>

          <!-- Step 2: Test -->
          <div class="flex flex-col items-center gap-2">
               <div class="w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all duration-500"
                   [class.bg-gray-800]="currentStep() < 2" [class.border-gray-600]="currentStep() < 2"
                   [class.bg-blue-900]="currentStep() === 2" [class.border-blue-500]="currentStep() === 2" [class.animate-pulse]="currentStep() === 2"
                   [class.bg-green-900]="currentStep() > 2" [class.border-green-500]="currentStep() > 2">
                   @if(currentStep() > 2) { <span class="material-icons text-green-500 text-sm">check</span> }
                   @else if(currentStep() === 2) { <span class="material-icons text-blue-500 text-sm animate-spin">sync</span> }
                   @else { <span class="text-gray-500 text-xs">2</span> }
              </div>
              <span class="text-xs font-bold" [class.text-blue-400]="currentStep() >= 2" [class.text-gray-500]="currentStep() < 2">Test</span>
          </div>

          <!-- Step 3: Deploy -->
          <div class="flex flex-col items-center gap-2">
              <div class="w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all duration-500"
                   [class.bg-gray-800]="currentStep() < 3" [class.border-gray-600]="currentStep() < 3"
                   [class.bg-blue-900]="currentStep() === 3" [class.border-blue-500]="currentStep() === 3" [class.animate-pulse]="currentStep() === 3"
                   [class.bg-green-900]="pipelineState() === 'success'" [class.border-green-500]="pipelineState() === 'success'">
                   @if(pipelineState() === 'success') { <span class="material-icons text-green-500 text-sm">rocket_launch</span> }
                   @else if(currentStep() === 3) { <span class="material-icons text-blue-500 text-sm animate-spin">sync</span> }
                   @else { <span class="text-gray-500 text-xs">3</span> }
              </div>
              <span class="text-xs font-bold" [class.text-blue-400]="currentStep() >= 3" [class.text-gray-500]="currentStep() < 3">Deploy</span>
          </div>
      </div>

      <!-- Console Logs -->
      <div class="bg-black rounded p-4 h-40 overflow-y-auto font-mono text-xs border border-gray-800">
          @for(log of logs(); track $index) {
              <div class="text-gray-300 mb-1">{{ log }}</div>
          }
          @if(pipelineState() === 'running') {
              <div class="text-blue-400 animate-pulse">_</div>
          }
          @if(pipelineState() === 'success') {
              <div class="text-green-400 font-bold mt-2">PIPELINE FINALIZADO COM SUCESSO.</div>
          }
      </div>
    </div>

    <p>
      Vamos colocar a teoria de CI/CD em prática. Usaremos o <strong>GitHub Actions</strong>, a ferramenta de automação integrada ao GitHub, para criar um pipeline que testa e implanta nossa aplicação.
    </p>

    <div class="pt-8 text-center">
       <a routerLink="/learning/devops-fundamentos" class="inline-flex items-center gap-2 px-6 py-3 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors">
        <span class="material-icons-outlined">arrow_forward</span>
        Próximo Passo: Infraestrutura como Código
      </a>
    </div>
  </article>
</div>
