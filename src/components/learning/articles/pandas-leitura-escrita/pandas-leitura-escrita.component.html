<div class="max-w-4xl mx-auto">
  <header class="mb-12">
    <div class="text-sm text-gray-400 mb-3 flex items-center gap-2">
      <a routerLink="/learning" class="hover:text-blue-accent hover:underline">Trilhas de Aprendizagem</a>
      <span class="material-icons-outlined text-base">chevron_right</span>
      <a routerLink="/learning/python-manipulacao-dados-pandas" class="hover:text-blue-accent hover:underline">Limpeza e Manipulação de Dados com Pandas</a>
    </div>
    <h1 class="text-4xl md:text-5xl font-bold text-white tracking-tight">Lendo e Escrevendo Dados (CSV, Excel)</h1>
    <p class="mt-4 text-lg text-gray-400">Aprenda a carregar dados de diferentes fontes para um DataFrame e a salvar seus resultados.</p>
  </header>
  <article class="prose-container space-y-10">
    <p>
      Raramente você criará um DataFrame do zero. Na maioria das vezes, o primeiro passo de qualquer projeto de análise de dados é carregar dados de um arquivo. O Pandas é excepcionalmente bom nisso, suportando uma vasta gama de formatos.
    </p>

    <div class="p-6 bg-gray-900 border border-gray-800 rounded-lg">
      <h2 class="text-2xl font-semibold text-white !mt-0">1. Lendo Arquivos CSV: O Pão com Manteiga</h2>
      <p>
        Arquivos CSV (Comma-Separated Values) são o formato mais comum para dados tabulares. A função <code>pd.read_csv()</code> é, sem dúvida, uma das mais usadas em todo o ecossistema de dados.
      </p>
      <div class="p-4 bg-gray-800 border border-gray-700 rounded-lg">
        <h4 class="text-sm font-semibold text-gray-300 mb-2">Exemplo: Lendo um CSV de uma URL</h4>
        <p class="text-xs text-gray-400">Vamos usar um conjunto de dados real e simples de passageiros do Titanic, hospedado online.</p>
        <pre class="!bg-gray-900 !p-3 !my-0"><code class="language-python">import pandas as pd

# URL do arquivo CSV
url = 'https://raw.githubusercontent.com/datasciencedojo/datasets/master/titanic.csv'

# O Pandas pode ler diretamente de uma URL!
df_titanic = pd.read_csv(url)

# Inspecionando as 5 primeiras linhas para ver se funcionou
print(df_titanic.head())</code></pre>
        <p class="text-xs text-gray-400 mt-2">Parâmetros úteis do `read_csv()`:</p>
        <ul class="list-disc list-inside text-xs text-gray-400 mt-2 pl-4">
          <li><code>sep=';'</code>: Se o seu arquivo usar ponto e vírgula em vez de vírgula como separador.</li>
          <li><code>header=None</code>: Se o seu arquivo não tiver uma linha de cabeçalho.</li>
          <li><code>names=['col1', 'col2']</code>: Para fornecer nomes de colunas quando <code>header=None</code>.</li>
        </ul>
      </div>
    </div>

    <div>
      <h2 class="text-2xl font-semibold text-white">2. Lendo Arquivos Excel</h2>
      <p>Ler arquivos do Excel (<code>.xls</code>, <code>.xlsx</code>) é igualmente simples com a função <code>pd.read_excel()</code>. No entanto, ela requer uma biblioteca adicional para funcionar.</p>
      <pre class="!bg-gray-950 !p-3 !my-2"><code class="language-bash"># Instale a biblioteca necessária para ler arquivos .xlsx
pip install openpyxl</code></pre>
      <div class="p-4 bg-gray-800 border border-gray-700 rounded-lg">
        <h4 class="text-sm font-semibold text-gray-300 mb-2">Exemplo: Lendo uma planilha do Excel</h4>
        <pre class="!bg-gray-900 !p-3 !my-0"><code class="language-python"># Suponha que você tenha um arquivo 'vendas.xlsx' na mesma pasta
# df_vendas = pd.read_excel('vendas.xlsx')

# Você pode especificar qual aba (sheet) quer ler
# df_regiao_sul = pd.read_excel('vendas.xlsx', sheet_name='Região Sul')

# print(df_vendas.head())</code></pre>
      </div>
    </div>

    <div>
      <h2 class="text-2xl font-semibold text-white">3. Escrevendo Dados: Salvando seu Trabalho</h2>
      <p>Após limpar, transformar e analisar seus dados, você precisará salvar os resultados. Os métodos <code>.to_csv()</code> e <code>.to_excel()</code> são a contraparte das funções de leitura.</p>
      <div class="p-4 bg-gray-800 border border-gray-700 rounded-lg">
        <h4 class="text-sm font-semibold text-gray-300 mb-2">Exemplo: Salvando um DataFrame em CSV e Excel</h4>
        <pre class="!bg-gray-900 !p-3 !my-0"><code class="language-python"># Vamos usar o DataFrame do Titanic que lemos antes
# (Supondo que 'df_titanic' já foi criado)

# Salvando em um novo arquivo CSV
# index=False é MUITO importante para não salvar o índice do Pandas como uma coluna extra
df_titanic.to_csv('titanic_output.csv', index=False)
print("Arquivo 'titanic_output.csv' salvo com sucesso!")

# Salvando em um novo arquivo Excel
# df_titanic.to_excel('titanic_output.xlsx', index=False, sheet_name='Passageiros')
# print("Arquivo 'titanic_output.xlsx' salvo com sucesso!")</code></pre>
      </div>
    </div>
    
     <div class="p-6 bg-green-900/30 border border-green-700/50 text-green-300 rounded-lg">
      <h3 class="font-semibold text-green-200 text-lg mb-2">Teste Você Mesmo!</h3>
      <p>
        O Pandas é incrivelmente versátil. Ele pode ler de JSON, de um banco de dados SQL, e até copiar de uma tabela em uma página HTML com <code>pd.read_html()</code>.
      </p>
      <p class="mt-2">
        <strong>Desafio:</strong> Encontre um conjunto de dados CSV simples online (o <a href="https://www.kaggle.com/datasets" target="_blank" rel="noopener noreferrer" class="font-semibold underline hover:text-green-200">Kaggle</a> é um ótimo lugar). Copie a URL do arquivo "raw" e use <code>pd.read_csv()</code> para carregá-lo em um DataFrame. Em seguida, imprima as 10 primeiras linhas usando <code>.head(10)</code>.
      </p>
    </div>

    <div class="pt-8 text-center">
       <a routerLink="/learning/python-manipulacao-dados-pandas" class="inline-flex items-center gap-2 px-6 py-3 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors">
        <span class="material-icons-outlined">arrow_forward</span>
        Próximo Passo: Seleção e Filtragem de Dados
      </a>
    </div>
  </article>
</div>
