<div class="max-w-4xl mx-auto">
  <header class="mb-12">
    <div class="text-sm text-gray-400 mb-3 flex items-center gap-2">
      <a routerLink="/learning" class="hover:text-blue-accent hover:underline">Trilhas de Aprendizagem</a>
      <span class="material-icons-outlined text-base">chevron_right</span>
      <a routerLink="/learning/python-machine-learning-sklearn" class="hover:text-blue-accent hover:underline">Introdução ao Machine Learning com Scikit-learn</a>
    </div>
    <h1 class="text-4xl md:text-5xl font-bold text-white tracking-tight">Laboratório: Preparando Dados (Feature Engineering)</h1>
    <p class="mt-4 text-lg text-gray-400">Descubra como transformar dados brutos, incluindo texto e categorias, em um formato que os modelos de Machine Learning entendam.</p>
  </header>
  <article class="prose-container space-y-12">
    <div class="p-6 bg-gray-900 border border-gray-800 rounded-lg">
      <h2 class="text-2xl font-semibold text-white !mt-0">Modelos só Entendem Números</h2>
      <p>
        Os algoritmos de Machine Learning, no fundo, são pura matemática. Eles não sabem o que "vermelho", "azul" ou "São Paulo" significa. Para que um modelo possa aprender, precisamos converter todos os nossos dados de entrada (features) em um formato numérico que ele possa entender.
      </p>
      <p>
        <strong>Feature Engineering</strong> é a arte e a ciência de transformar dados brutos em "features" (características) que representem bem o problema e ajudem o modelo a fazer previsões melhores. É frequentemente a etapa que mais impacta a performance de um modelo.
      </p>
    </div>

    <!-- One-Hot Encoding Lab -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">1. Dados Categóricos: One-Hot Encoding</h2>
      <p class="text-gray-300 mb-6">
        A solução para dados categóricos (texto) é o <strong>One-Hot Encoding</strong>. Ele transforma uma coluna de texto em várias colunas binárias (0 ou 1), uma para cada categoria possível. Clique no botão para ver a transformação.
      </p>

      <div class="p-6 bg-gray-900 border border-gray-800 rounded-xl text-center">
        <button (click)="oneHotEncoded.set(!oneHotEncoded())" class="mb-6 px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-full transition-transform hover:scale-105 flex items-center gap-2 mx-auto">
          <span class="material-icons-outlined">transform</span>
          {{ oneHotEncoded() ? 'Ver Original' : 'Aplicar One-Hot Encoding' }}
        </button>
        
        <div class="grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-4 items-center">
            <!-- Tabela "Antes" -->
            <div class="text-left">
                <h4 class="text-xs text-gray-400 uppercase font-bold mb-2">Antes</h4>
                <table class="w-full text-left text-sm text-gray-300 border-collapse">
                    <thead class="text-xs text-gray-500 bg-gray-800">
                        <tr><th class="px-4 py-2">cor</th></tr>
                    </thead>
                    <tbody>
                        @for(row of oneHotBefore; track $index) {
                            <tr class="border-b border-gray-800 font-mono">
                                <td class="px-4 py-2">{{ row.cor }}</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            <!-- Seta de Transformação -->
            <div class="text-gray-600 text-4xl transition-opacity duration-500 hidden md:block" [class.opacity-100]="oneHotEncoded()" [class.opacity-0]="!oneHotEncoded()">
              &rarr;
            </div>
            
            <!-- Tabela "Depois" -->
            <div class="text-left transition-opacity duration-500" [class.opacity-100]="oneHotEncoded()" [class.opacity-0]="!oneHotEncoded()">
                <h4 class="text-xs text-green-400 uppercase font-bold mb-2">Depois</h4>
                <table class="w-full text-left text-sm text-gray-300 border-collapse">
                    <thead class="text-xs text-gray-500 bg-gray-800">
                        <tr>
                            <th class="px-2 py-2">cor_azul</th>
                            <th class="px-2 py-2">cor_verde</th>
                            <th class="px-2 py-2">cor_vermelho</th>
                        </tr>
                    </thead>
                    <tbody>
                         @for(row of oneHotAfter; track $index) {
                            <tr class="border-b border-gray-800 font-mono">
                                <td class="px-2 py-2 text-center">{{ row.cor_azul }}</td>
                                <td class="px-2 py-2 text-center">{{ row.cor_verde }}</td>
                                <td class="px-2 py-2 text-center">{{ row.cor_vermelho }}</td>
                            </tr>
                         }
                    </tbody>
                </table>
            </div>
        </div>
      </div>
    </section>
    
    <!-- Standardization Lab -->
    <section>
      <h2 class="text-2xl font-semibold text-white mb-4">2. Dados Numéricos: Padronização (Standardization)</h2>
      <p class="text-gray-300 mb-6">
        Se uma feature (como "salário") tem valores muito maiores que outra ("idade"), ela pode dominar o modelo. A padronização com o <strong>StandardScaler</strong> do Scikit-learn coloca todas as features na mesma escala, garantindo que o modelo dê a devida importância a cada uma. Ela transforma os dados para que tenham uma média de 0 e desvio padrão de 1.
      </p>

      <div class="p-6 bg-gray-900 border border-gray-800 rounded-xl text-center">
        <button (click)="standardized.set(!standardized())" class="mb-6 px-6 py-2 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-full transition-transform hover:scale-105 flex items-center gap-2 mx-auto">
          <span class="material-icons-outlined">scale</span>
          {{ standardized() ? 'Ver Original' : 'Aplicar Padronização' }}
        </button>

        <div class="overflow-x-auto">
            <table class="w-full min-w-full text-center text-sm text-gray-300 border-collapse">
                <thead class="text-xs text-gray-500 bg-gray-800">
                    <tr>
                        <th class="px-4 py-2">idade</th>
                        <th class="px-4 py-2">salario</th>
                    </tr>
                </thead>
                <tbody>
                    @if(!standardized()) {
                        @for(row of standardBefore; track $index) {
                            <tr class="border-b border-gray-800 font-mono">
                                <td class="px-4 py-2">{{ row.idade }}</td>
                                <td class="px-4 py-2">{{ row.salario }}</td>
                            </tr>
                        }
                    } @else {
                         @for(row of standardAfter; track $index) {
                            <tr class="border-b border-gray-800 font-mono transition-colors duration-500">
                                <td class="px-4 py-2 text-purple-300">{{ row.idade }}</td>
                                <td class="px-4 py-2 text-purple-300">{{ row.salario }}</td>
                            </tr>
                         }
                    }
                </tbody>
            </table>
        </div>
      </div>
    </section>

    <div class="pt-8 text-center">
       <a routerLink="/learning/article/sklearn-pipeline" class="inline-flex items-center gap-2 px-6 py-3 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors">
        <span class="material-icons-outlined">arrow_forward</span>
        Próximo Passo: Construindo um Pipeline Completo
      </a>
    </div>
  </article>
</div>
