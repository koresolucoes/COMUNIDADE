<div class="space-y-6">
  <div>
    <h1 class="text-3xl md:text-4xl font-bold text-white">Construtor de Grid CSS</h1>
    <p class="mt-2 text-gray-400">Desenhe layouts de grid visualmente e gere o c√≥digo CSS e HTML correspondente.</p>
  </div>
  <!-- Top Controls -->
  <div class="flex flex-wrap items-center gap-x-6 gap-y-4 p-4 bg-gray-900 border border-gray-800 rounded-lg">
    <div class="flex items-center gap-2">
      <label for="cols" class="text-sm font-medium text-gray-400">Colunas:</label>
      <input id="cols" type="number" min="2" max="24" [ngModel]="cols()" (ngModelChange)="cols.set(+$event)" class="w-20 bg-gray-800 border-gray-700 text-white rounded-md p-2 text-center focus:ring-blue-accent focus:border-blue-accent">
    </div>
    <div class="flex items-center gap-2">
      <label for="rows" class="text-sm font-medium text-gray-400">Linhas:</label>
      <input id="rows" type="number" min="2" max="24" [ngModel]="rows()" (ngModelChange)="rows.set(+$event)" class="w-20 bg-gray-800 border-gray-700 text-white rounded-md p-2 text-center focus:ring-blue-accent focus:border-blue-accent">
    </div>
    <div class="flex items-center gap-2">
      <label for="gap" class="text-sm font-medium text-gray-400">Gap (px):</label>
      <input id="gap" type="number" min="0" max="50" [ngModel]="gap()" (ngModelChange)="gap.set(+$event)" class="w-20 bg-gray-800 border-gray-700 text-white rounded-md p-2 text-center focus:ring-blue-accent focus:border-blue-accent">
    </div>
    <div class="flex-grow"></div>
    <button (click)="loadHolyGrail()" class="px-4 py-2 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors flex items-center gap-2 text-sm">
      <span class="material-icons-outlined text-base">dashboard</span>
      Exemplo "Holy Grail"
    </button>
    <button (click)="resetGrid()" class="px-4 py-2 bg-red-600/20 text-red-400 rounded-md font-semibold hover:bg-red-600/30 transition-colors flex items-center gap-2 text-sm">
      <span class="material-icons-outlined text-base">refresh</span>
      Resetar
    </button>
  </div>

  <!-- Interactive Grid Preview Wrapper -->
  <div #gridContainer class="grid-preview-wrapper flex-grow w-full bg-gray-900 border border-gray-800 rounded-lg p-2 select-none">
    <!-- Background Canvas (for clicking) -->
    <div 
        class="grid-canvas"
        [style.grid-template-columns]="'repeat(' + cols() + ', 1fr)'"
        [style.grid-template-rows]="'repeat(' + rows() + ', 1fr)'"
        [style.gap.px]="gap()">
      @for(_ of cellArray(); track $index) {
        <div class="grid-cell" (click)="addItem($index)">
            <span class="material-icons-outlined">add</span>
        </div>
      }
    </div>

    <!-- Foreground Canvas (for rendering items) -->
    <div 
        class="grid-canvas"
        [style.grid-template-columns]="'repeat(' + cols() + ', 1fr)'"
        [style.grid-template-rows]="'repeat(' + rows() + ', 1fr)'"
        [style.gap.px]="gap()">
      @for(item of items(); track item.id) {
        <div class="grid-item" 
            [style.grid-column]="item.colStart + ' / ' + item.colEnd" 
            [style.grid-row]="item.rowStart + ' / ' + item.rowEnd"
            [style.background-color]="item.color"
            >
          <span class="item-id">{{ item.id }}</span>
          <button (click)="removeItem(item.id)" class="remove-btn">
            <span class="material-icons-outlined">close</span>
          </button>
          <div class="resize-handle" (mousedown)="onResizeStart($event, item)"></div>
        </div>
      }

      <!-- Resize Preview (Ghost) Element -->
      @if (resizeState().active && resizeState().itemInitialState && previewSpan(); as span) {
        <div class="resize-preview" [style.grid-column]="resizeState().itemInitialState!.colStart + ' / ' + span.colEnd" [style.grid-row]="resizeState().itemInitialState!.rowStart + ' / ' + span.rowEnd">
        </div>
      }
    </div>
  </div>


  <!-- Code Output -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="flex flex-col">
      <h3 class="text-lg font-semibold text-white mb-2">HTML Gerado</h3>
      <pre class="code-output flex-grow"><code>{{ htmlCode() }}</code></pre>
    </div>
     <div class="flex flex-col">
      <h3 class="text-lg font-semibold text-white mb-2">CSS Gerado</h3>
      <pre class="code-output flex-grow"><code>{{ cssCode() }}</code></pre>
    </div>
  </div>

  <app-tool-info-section [sections]="infoSections()"></app-tool-info-section>
</div>