<div class="space-y-8 h-full flex flex-col">
  <div>
    <h1 class="text-3xl md:text-4xl font-bold text-white">Gerador de Dados Falsos (Mock Data)</h1>
    <p class="mt-2 text-gray-400">Gere arrays de JSON com dados falsos para testar seus workflows e APIs.</p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 flex-grow min-h-0">
    <!-- Left Column: Schema Builder -->
    <div class="flex flex-col min-h-0">
      <h2 class="text-lg font-semibold text-white mb-2">Estrutura (Schema)</h2>
      <div class="w-full h-full bg-gray-900 border border-gray-700 rounded-md p-4 space-y-3 overflow-y-auto">
        @for(field of schemaFields(); track field.id) {
          <div class="flex items-center gap-2 bg-gray-800 p-2 rounded-md">
            <input 
              type="text"
              placeholder="Nome do Campo"
              class="flex-1 bg-gray-700 border-gray-600 text-white rounded-md p-2 text-sm focus:ring-blue-accent focus:border-blue-accent"
              [ngModel]="field.key"
              (ngModelChange)="updateField(field.id, 'key', $event)">
            
            <select 
              class="flex-1 bg-gray-700 border-gray-600 text-white rounded-md p-2 text-sm focus:ring-blue-accent focus:border-blue-accent"
              [ngModel]="field.type"
              (ngModelChange)="updateField(field.id, 'type', $event)">
              @for(group of groupedDataTypes(); track group[0]) {
                <optgroup [label]="group[0]">
                  @for(type of group[1]; track type.id) {
                    <option [value]="type.id">{{ type.name }}</option>
                  }
                </optgroup>
              }
            </select>
            
            <button (click)="removeField(field.id)" class="p-2 text-gray-500 hover:text-red-400 rounded-full hover:bg-gray-700">
              <span class="material-icons-outlined">delete</span>
            </button>
          </div>
        }

        <button (click)="addField()" class="w-full mt-2 px-4 py-2 bg-gray-700/50 border border-dashed border-gray-600 text-gray-300 rounded-md font-semibold hover:bg-gray-700 hover:border-gray-500 transition-colors flex items-center justify-center gap-2">
          <span class="material-icons-outlined">add</span>
          Adicionar Campo
        </button>
      </div>
      <div class="mt-4">
        <label for="record-count" class="block text-sm font-medium text-gray-400 mb-2">Quantidade de Registros</label>
        <input 
          type="number" 
          id="record-count"
          min="1"
          max="1000"
          class="w-full bg-gray-800 border-gray-700 text-white rounded-md p-2 focus:ring-blue-accent focus:border-blue-accent"
          [ngModel]="recordCount()"
          (ngModelChange)="recordCount.set(+$event)">
      </div>
    </div>

    <!-- Right Column: Output -->
    <div class="flex flex-col min-h-0">
       <h2 class="text-lg font-semibold text-white mb-2">Resultado JSON</h2>
       <div class="relative w-full h-full">
        <textarea 
          readonly
          class="w-full h-full bg-gray-900 border border-gray-700 font-mono text-gray-300 rounded-md p-4 resize-y"
          placeholder="Clique em 'Gerar Dados' para ver o resultado"
          [value]="generatedJson()">
        </textarea>
        @if(generatedJson()) {
          <button (click)="copyToClipboard()" class="absolute top-3 right-3 px-3 py-1 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors text-xs">
            {{ copyButtonText() }}
          </button>
        }
      </div>
    </div>
  </div>

  <div class="pt-4 flex flex-col gap-4">
    <button (click)="generateData()" class="w-full px-4 py-3 bg-blue-accent text-white rounded-md font-semibold hover:bg-blue-accent/90 transition-colors flex items-center justify-center gap-2">
      <span class="material-icons-outlined">play_circle</span>
      Gerar Dados
    </button>
    
    @if(currentUser()) {
      <div class="flex items-center gap-4 pt-4 border-t border-gray-800">
        <button (click)="saveData()" class="px-4 py-2 bg-gray-700 text-white rounded-md font-semibold hover:bg-gray-600 transition-colors flex items-center gap-2">
          <span class="material-icons-outlined text-base">save</span>
          Salvar Schema
        </button>
        <a routerLink="/profile" class="text-sm font-medium text-blue-accent hover:underline">
          Meus Schemas Salvos
        </a>
      </div>
    }
  </div>
</div>
