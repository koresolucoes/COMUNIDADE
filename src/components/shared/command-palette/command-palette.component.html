<div class="fixed inset-0 z-50 bg-gray-950/80 backdrop-blur-sm flex justify-center items-start pt-20">
  <div class="w-full max-w-xl bg-gray-900 border border-gray-700 rounded-lg shadow-2xl overflow-hidden">
    <div class="relative">
      <input 
        #searchInput
        type="text" 
        placeholder="Digite um comando ou busque..."
        class="w-full bg-gray-900 border-b border-gray-700 p-4 text-white placeholder-gray-500 focus:outline-none"
        [value]="query()"
        (input)="onInput($event)"
        (keydown)="handleKeydown($event)">
      <div class="absolute inset-y-0 right-0 flex items-center pr-4 text-gray-500">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
        </svg>
      </div>
    </div>
    <div class="max-h-[60vh] overflow-y-auto">
      @if (filteredCommands().length === 0) {
        <p class="text-center text-gray-500 p-6">Nenhum resultado encontrado.</p>
      } @else {
        @for(group of groupedCommands(); track group[0]; let groupIndex = $index) {
          <div class="p-2">
            <h3 class="text-xs font-semibold text-gray-500 px-3 pt-2 pb-1">{{ group[0] }}</h3>
            <ul>
              @for(command of group[1]; track command.name; let itemIndex = $index) {
                <li 
                  (click)="executeCommand(command)"
                  [class.bg-blue-accent/20]="filteredCommands().indexOf(command) === activeIndex()"
                  class="flex items-center gap-4 p-3 mx-2 rounded-md cursor-pointer hover:bg-gray-800">
                   <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-gray-400">
                     <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="command.icon" />
                   </svg>
                  <span class="text-sm text-gray-200">{{ command.name }}</span>
                </li>
              }
            </ul>
          </div>
        }
      }
    </div>
  </div>
</div>
